# 词库格式

本项目的词库本质上是“英文字符串 → 中文字符串”的映射表。

## 基础结构

推荐使用扁平的键值对：

- key：页面上出现的英文文案（精确匹配）
- value：对应中文译文

仓库内示例：`i18n/zh-cn.json`。

如果你希望将 `i18n/zh-cn.json` 作为主要维护入口，并同步给不同脚本变体使用，参考 [词库同步与工作流](../howto/sync-dictionary.md)。

## 空字符串与未命中

不同脚本变体对“空字符串译文”与“未命中”处理方式可能不同：

- 空字符串译文：用于“有意删除某段文案”的场景，但风险高，应谨慎使用。
- 未命中：应保持原文不变，而不是替换为 `undefined`/空白。

## 重复 Key（Duplicates）

JSON 语义上对象的 key 不应重复，但在手动合并分支、复制粘贴或编辑器格式化时，文本层面仍可能出现“重复 key”的情况。

仓库内会对 `i18n/zh-cn.json` 做自动去重与规范化：

- 重复 key 的覆盖规则：保留最后一次出现的 key（last-wins）。
- 规范化输出：缩进 4 空格、UTF-8、文件末尾带换行。

建议：

- 贡献词条时尽量保证一个 key 只对应一个译文，避免依赖“重复 key 覆盖”来表达语义。
- 如果遇到同 key 多个译文，先做取舍，保留最终版本，再提交。

## 动态文本

遇到包含动态片段的文本（数字、时间、分支名等），优先使用“规则”而不是在词库中枚举所有可能值：

- `old1.user.js` 使用 `REGEX_RULES` 维护正则替换规则。

## old2.user.js 的外置词库

`old2.user.js` 通过外部脚本注入全局变量 `window.VERCEL_I18N_DATA`，其结构等价于一个普通的键值对象：

- `window.VERCEL_I18N_DATA["Overview"] === "概览"`
